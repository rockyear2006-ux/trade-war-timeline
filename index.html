<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>中美贸易战时间线</title>
  <script src="https://unpkg.com/vis-timeline@latest/standalone/umd/vis-timeline-graph2d.min.js"></script>
  <link href="https://unpkg.com/vis-timeline@latest/styles/vis-timeline-graph2d.min.css" rel="stylesheet">
  <style>
        /* 修复刻度乱码 */
    .vis-time-axis .vis-text,
    .vis-time-axis .vis-major,
    .vis-time-axis .vis-minor {
      font-family: Arial, Helvetica, sans-serif !important;
    }
    body { font-family: Arial, Helvetica, sans-serif; padding: 20px; }
  </style>
</head>
<body>
  <h2>中美贸易战最新进展（自动更新）</h2>
  <div id="timeline" style="height:350px;"></div>

<script>
  async function load() {
    const nodes = await fetch('event.json?' + Date.now()).then(r => r.json());
    const items = nodes.map((n, idx) => ({
      id: idx,
      content: n.title,
      start: n.date,
      className: n.type
    }));

    // 不再注册中文，直接用英文默认
    new vis.Timeline(
      document.getElementById('timeline'),
      items,
      {
        width: '100%',
        height: '350px',
        locale: 'en',                       // 英文 locale
        zoomMin: 1000 * 60 * 60,            // 最小 1 小时
        zoomMax: 1000 * 60 * 60 * 24 * 365, // 最大 1 年
        timeAxis: { scale: 'hour', step: 1 }, // 刻度最小单位：小时
        format: {
          minorLabels: {
            hour: 'HH:mm'   // 09:30
          },
          majorLabels: {
            hour: 'ddd D MMM' // Mon 13 Jun
          }
        }
      }
    );
  }

  load();
  setInterval(load, 120000);
</script>

  <style>
    .red  { background: #ff4d4f; color: #fff; }
    .blue { background: #1890ff; color: #fff; }
    .gray { background: #bfbfbf; color: #fff; }
  </style>
</body>
</html>
